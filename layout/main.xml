<body>
    <pad id="main">

        <right>
            <hc>
                <button id="start_all" text="{Start all}" icon="play" style="mini" />
                <button id="stop_all" text="{Stop all}" icon="stop" style="mini" />
            </hc>
        </right>

        <hc>
            <button id="refresh" icon="refresh" text="{Refresh}" style="mini" />
            <button id="add" text="{Add torrent}" icon="download-alt" style="mini" />
            <button id="config" text="{Session config}" icon="cogs" style="mini" />
        </hc>

        <vc>
            <tabs id="status_filter">
                <tab title="{All}" />
                <tab title="{Downloading}" />
                <tab title="{Seeding}" />
                <tab title="{Stopped}" />
            </tabs>

            <bind:collection bind="torrents" id="torrents">
                <dt bind="__items">
                    <dtr>
                        <dth width="1%" />
                        <dth text="{Name}" />
                        <dth width="150" text="{Progress}" />
                        <dth width="40" text="{Priority}" />
                        <dth width="60" text="{Actions}" />
                    </dtr>
                </dt>
                <bind:template>
                    <dtr>
                        <dtd><tooltip bind="status"><icon bind="icon" /></tooltip></dtd>
                        <dtd>
                            <collapse>
                                <button id="details" style="link" bind:text="name" />

                                <lt>
                                    <ltr bind:visible="status" bindtransform="lambda s: s == 'downloading'">
                                        <ltd>
                                            <icon icon="hdd" />
                                            <label style="small" bind="size_now" bindtransform="lambda s: str_fsize(s or 0)" />
                                            <label style="small" text="/" />
                                            <label style="small" bind="size_when_done" bindtransform="lambda s: str_fsize(s or 0)" />
                                        </ltd>

                                        <ltd>
                                            <icon icon="arrow-down" />
                                            <label style="small" bind="peers_sending_to_us" />
                                            <label style="small" text="@" />
                                            <label style="small" bind="rate_download" bindtransform="lambda s: str_fsize(s or 0)" />
                                        </ltd>

                                        <ltd>
                                            <icon icon="time" />
                                            <label style="small" bind="eta" bindtransform="str" />
                                        </ltd>
                                    </ltr>

                                    <ltr bind:visible="status" bindtransform="lambda s: s == 'seeding'">
                                        <ltd>
                                            <icon icon="hdd" />
                                            <label style="small" bind="size_now" bindtransform="lambda s: str_fsize(s or 0)" />
                                        </ltd>

                                        <ltd>
                                            <icon icon="arrow-up" />
                                            <label style="small" bind="peers_getting_from_us" />
                                            <label style="small" text="@" />
                                            <label style="small" bind="rate_upload" bindtransform="lambda s: str_fsize(s or 0)" />
                                        </ltd>

                                        <ltd>
                                            <icon icon="exchange" />
                                            <label style="small" bind="upload_ratio" />
                                        </ltd>
                                    </ltr>

                                    <ltr bind:visible="status" bindtransform="lambda s: s == 'checking'">
                                        <ltd>
                                            <icon icon="hdd" />
                                            <label style="small" bind="size_now" bindtransform="lambda s: str_fsize(s or 0)" />
                                        </ltd>

                                        <ltd>
                                            <hc>
                                                <icon icon="stethoscope" />
                                                <label bind="recheck_progress" bindtransform="lambda x: '%0.2f%%' % (x * 100)"  style="mini" />
                                                <progressbar bind="recheck_progress" width="100" />
                                            </hc>
                                        </ltd>
                                    </ltr>

                                    <ltr bind:visible="status" bindtransform="lambda s: s == 'stopped'">
                                        <ltd>
                                            <icon icon="hdd" />
                                            <label style="small" bind="size_now" bindtransform="lambda s: str_fsize(s or 0)" />
                                            <label style="small" text="/" />
                                            <label style="small" bind="size_when_done" bindtransform="lambda s: str_fsize(s or 0)" />
                                        </ltd>
                                    </ltr>
                                </lt>
                            </collapse>
                        </dtd>
                        <dtd>
                            <hc>
                                <label bind="percent_done" bindtransform="lambda x: '%0.2f%%' % (x * 100)"  style="mini" />
                                <progressbar bind="percent_done" width="100" />
                            </hc>
                        </dtd>
                        <dtd>
                            <tooltip text="{Toggle priority}"><button style="link" bind:text="bandwidth_priority" id="toggle_priority" /></tooltip>
                        </dtd>
                        <dtd>
                            <hc>
                                <tooltip text="Start"><button id="start" icon="play" style="mini" bind:visible="status" bindtransform="lambda s: s == 'stopped'" /></tooltip>
                                <tooltip text="Stop"><button id="stop" icon="pause" style="mini" bind:visible="status" bindtransform="lambda s: s != 'stopped'" /></tooltip>
                                <tooltip text="Recheck"><button id="recheck" icon="repeat" bind:visible="status" bindtransform="lambda s: s != 'checking'" style="mini" /></tooltip>
                                <tooltip text="Remove"><button bind="__delete" icon="remove" style="mini" warning="Remove the torrent from list?" /></tooltip>
                            </hc>
                        </dtd>
                    </dtr>
                </bind:template>
            </bind:collection>

            <formgroup text="{Torrent info}" bind:visible="torrent" bindtransform="bool">
                <vc>
                    

                    <tabs>
                        <tab title="{Info}">
                            <bind:dict bind="torrent" id="torrent">
                                <dt>
                                    <dtr>
                                        <dth text="{Name}" width="120" />
                                        <dtd>
                                            <collapse>
                                                <label bind="name" />
                                                <textbox bind="torrent_file" readonly="True" style="big" />
                                            </collapse>
                                        </dtd>
                                        <dth text="{Priority}" />
                                        <dtd><label bind="bandwidth_priority" /></dtd>
                                    </dtr>
                                    <dtr>
                                        <dth text="{Destionation}" />
                                        <dtd>
                                            <hc>
                                                <pathbox directory="True" style="big" bind="download_dir" id="download_dir" />
                                                <tooltip text="{Move files}"><button style="mini" id="move" icon="ok" /></tooltip>
                                            </hc>
                                        </dtd>
                                        <dth text="{Peers}" />
                                        <dtd>
                                            <lt>
                                                <ltr>
                                                    <ltd><icon icon="arrow-down" /><label bind="peers_sending_to_us" /></ltd>
                                                    <ltd><icon icon="arrow-up" /><label bind="peers_getting_from_us" /></ltd>
                                                    <ltd><icon icon="exchange" /><label bind="peers_connected" /></ltd>
                                                </ltr>
                                            </lt>
                                        </dtd>
                                    </dtr>
                                    <dtr>
                                        <dth text="{Speed}" />
                                        <dtd>
                                            <lt>
                                                <ltr>
                                                    <ltd><icon icon="arrow-down" /><label bind="rate_download" bindtransform="lambda s: str_fsize(s or 0)" /></ltd>
                                                    <ltd><icon icon="arrow-up" /><label bind="rate_upload" bindtransform="lambda s: str_fsize(s or 0)" /></ltd>
                                                    <ltd><icon icon="time" /><label bind="eta" bindtransform="str" /></ltd>
                                                </ltr>
                                            </lt>
                                        </dtd>
                                        <dth text="{Time}" />
                                        <dtd>
                                            <lt>
                                                <ltr>
                                                    <ltd><icon icon="arrow-down" /><label bind="seconds_downloading" bindtransform="str" /></ltd>
                                                    <ltd><icon icon="arrow-up" /><label bind="seconds_seeding" bindtransform="str" /></ltd>
                                                </ltr>
                                            </lt>
                                        </dtd>
                                    </dtr>
                                    <dtr>
                                        <dth text="{Volume}" />
                                        <dtd>
                                            <lt>
                                                <ltr>
                                                    <ltd><icon icon="arrow-down" /><label bind="downloaded_ever" bindtransform="lambda s: str_fsize(s or 0)" /></ltd>
                                                    <ltd><icon icon="arrow-up" /><label bind="uploaded_ever" bindtransform="lambda s: str_fsize(s or 0)" /></ltd>
                                                    <ltd><icon icon="exchange" /><label bind="upload_ratio" /></ltd>
                                                </ltr>
                                            </lt>
                                        </dtd>
                                        <dth text="{Size}" />
                                        <dtd>
                                            <label bind="total_size" bindtransform="lambda s: str_fsize(s or 0)" />
                                            <label text=", selected " />
                                            <label bind="size_when_done" bindtransform="lambda s: str_fsize(s or 0)" />
                                        </dtd>
                                    </dtr>
                                    <dtr>
                                        <dth text="{Timestamps}" />
                                        <dtd>
                                            <lt>
                                                <ltr>
                                                    <ltd><label style="bold" text="{Created }" /><label bind="date_created" bindtransform="lambda d: d and d.strftime('%b %d %Y, %H:%M')" /></ltd>
                                                    <ltd><label style="bold" text="{Added }" /><label bind="added_date" bindtransform="lambda d: d and d.strftime('%b %d %Y, %H:%M')" /></ltd>
                                                </ltr>
                                            </lt>
                                        </dtd>
                                        <dth text="{Run date}" />
                                        <dtd>
                                            <hc>
                                                <label bind="start_date" bindtransform="lambda d: d and d.strftime('%b %d %Y, %H:%M')" /><label text=" — " /><label bind="done_date" bindtransform="lambda d: d and d.strftime('%b %d %Y, %H:%M')" />
                                            </hc>
                                        </dtd>
                                    </dtr>
                                </dt>
                            </bind:dict>
                        </tab>

                        <tab title="{Limits}">
                            <bind:dict bind="torrent">
                                <formline text="{Download limits}">
                                    <hc>
                                        <textbox bind="download_limit" type="number" />
                                        <checkbox bind="download_limited" text="{Use}" />
                                    </hc>
                                </formline>
                                <formline text="{Upload limits}">
                                    <hc>
                                        <textbox bind="upload_limit" type="number" />
                                        <checkbox bind="upload_limited" text="{Use}" />
                                    </hc>
                                </formline>
                                <formline text="{Ratio limits}">
                                    <hc>
                                        <textbox bind="seed_ratio_limit" type="number" />
                                        <dropdown values="['global', 'single', 'limited']" labels="['Global', 'Single', 'Limited']" bind="seed_ratio_mode" />
                                    </hc>
                                </formline>
                                <formline text="{Global limits}">
                                    <checkbox bind="honors_session_limits" text="{Honor session limits}" />
                                </formline>
                                <formline>
                                    <button id="apply_limits" text="{Apply changes}" icon="ok" />
                                </formline>
                            </bind:dict>
                        </tab>

                        <tab title="{Files}">
                            <bind:collection bind="files" id="files">
                                <button id="apply_files" icon="ok" text="{Apply changes}" />

                                <dt bind="__items">
                                    <dtr>
                                        <dth width="1%" />
                                        <dth text="{Name}" />
                                        <dth text="{Size}" />
                                        <dth text="{Progress}" />
                                        <dth width="40" text="{Priority}" />
                                    </dtr>
                                </dt>
                                <bind:template>
                                    <dtr>
                                        <dtd><checkbox bind="wanted" /></dtd>
                                        <dtd><label bind="name" /></dtd>
                                        <dtd><label bind="bytes_completed" bindtransform="lambda s: str_fsize(s or 0)" /><label text=" / " /><label bind="length" bindtransform="lambda s: str_fsize(s or 0)" /></dtd>
                                        <dtd>
                                            <hc>
                                                <label bind="percent_done" bindtransform="lambda x: '%0.2f%%' % (x * 100)" style="mini" />
                                                <progressbar bind="percent_done" width="100" />
                                            </hc>
                                        </dtd>
                                        <dtd>
                                            <hc>
                                                <tooltip text="Low priority"><togglebutton id="priority_low" bind:pressed="priority" bindtransform="lambda p: p == 'low'" icon="arrow-down" style="mini" /></tooltip>
                                                <tooltip text="Normal priority"><togglebutton id="priority_normal" bind:pressed="priority" bindtransform="lambda p: p == 'normal'" icon="minus" style="mini" /></tooltip>
                                                <tooltip text="High priority"><togglebutton id="priority_high" bind:pressed="priority" bindtransform="lambda p: p == 'high'" icon="arrow-up" style="mini" /></tooltip>
                                            </hc>
                                        </dtd>
                                    </dtr>
                                </bind:template>
                            </bind:collection>
                        </tab>

                        <tab title="{Peers}">
                            <bind:collection bind="peers" id="peers">
                                <dt bind="__items">
                                    <dtr>
                                        <dth width="1%" />
                                        <dth text="{Client}" />
                                        <dth width="120" text="{Address}" />
                                        <dth width="180" text="{Speed}" />
                                        <dth width="150" text="{Progress}" />
                                    </dtr>
                                </dt>
                                <bind:template>
                                    <dtr>
                                        <dtd>
                                            <hc>
                                                <tooltip text="{I'm choked}"><icon icon="pause" bind:visible="client_is_choked" /></tooltip>
                                                <tooltip text="{Peer is choked}"><icon icon="stop" bind:visible="peer_is_choked" /></tooltip>
                                                <tooltip text="{I'm interested}"><icon icon="circle-arrow-down" bind:visible="client_is_interesed" /></tooltip>
                                                <tooltip text="{Peer is interested}"><icon icon="circle-arrow-up" bind:visible="peer_is_interesed" /></tooltip>
                                                <tooltip text="{Downloading}"><icon icon="download-alt" bind:visible="is_downloading_from" /></tooltip>
                                                <tooltip text="{Uploading}"><icon icon="upload-alt" bind:visible="is_uploading_to" /></tooltip>
                                                <tooltip text="{μTP}"><icon icon="exchange" bind:visible="is_u_t_p" /></tooltip>
                                                <tooltip text="{Encrypted}"><icon icon="lock" bind:visible="is_encrypted" /></tooltip>
                                            </hc>
                                        </dtd>
                                        <dtd>
                                            <label bind="client_name" />
                                        </dtd>
                                        <dtd>
                                            <label bind="address" /><label text=":" /><label bind="port" />
                                        </dtd>
                                        <dtd>
                                            <lt>
                                                <ltr>
                                                    <ltd><icon icon="arrow-down" /><label bind="rate_to_client" bindtransform="lambda s: str_fsize(s or 0)" /></ltd>
                                                    <ltd><icon icon="arrow-up" /><label bind="rate_to_peer" bindtransform="lambda s: str_fsize(s or 0)" /></ltd>
                                                </ltr>
                                            </lt>
                                        </dtd>
                                        <dtd>
                                            <hc>
                                                <label bind="progress" bindtransform="lambda x: '%0.2f%%' % (x * 100)" style="mini" />
                                                <progressbar bind="progress" width="100" />
                                            </hc>
                                        </dtd>
                                    </dtr>
                                </bind:template>
                            </bind:collection>
                        </tab>

                        <tab title="{Trackers}">
                            <bind:collection bind="trackers" id="trackers">
                                <dt bind="__items">
                                    <dtr>
                                        <dth width="1%" />
                                        <dth text="{Announce / scrape}" />
                                        <dth text="{Tier}" />
                                    </dtr>
                                </dt>
                                <bind:template>
                                    <dtr>
                                        <dtd><icon icon="link" /></dtd>
                                        <dtd>
                                            <lt>
                                                <ltr>
                                                    <ltd><icon icon="arrow-up" /></ltd><ltd><label bind="announce" /></ltd>
                                                </ltr>
                                                <ltr>
                                                    <ltd><icon icon="arrow-down" /></ltd><ltd><label bind="scrape" /></ltd>
                                                </ltr>
                                            </lt>
                                        </dtd>
                                        <dtd><label bind="tier" /></dtd>
                                    </dtr>
                                </bind:template>
                            </bind:collection>
                        </tab>

                        <tab title="{Map}">
                            <contentbox width="100%" height="300" bind="pieces" bindtransform="str" />
                        </tab>
                    </tabs>
                </vc>
            </formgroup>
        </vc>
    </pad>

    <dialog visible="False" id="add_dialog" buttons="[
        {'id': 'add', 'text': _('Add')},
        {'id': 'cancel', 'text': _('Cancel')}
        ]">
        <pad>
            <formgroup text="{Add new torrent}">
                <vc>
                    <formline text="{URL}">
                        <textbox id="url" />
                    </formline>
                    <formline text="{Local file}">
                        <pathbox id="local_file" />
                    </formline>
                    <formline text="{Upload file}">
                        <fileupload id="upload_file" target="ajenti:transmission-upload" />
                    </formline>
                </vc>
            </formgroup>

            <formgroup text="{Download options}">
                <vc>
                    <formline text="{Download to}">
                        <pathbox id="target_dir" directory="True" />
                    </formline>
                    <formline>
                        <checkbox text="{Pause on add}" id="add_paused" value="True" />
                    </formline>
                </vc>
            </formgroup>
        </pad>
    </dialog>

    <dialog visible="False" id="session_dialog" buttons="[
        {'id': 'apply', 'text': _('Apply')},
        {'id': 'cancel', 'text': _('Cancel')}
        ]">
        <pad>
            <formgroup text="{Storage options}">
                <vc>
                    <formline text="{Download directory}">
                        <pathbox directory="True" bind="download_dir" />
                    </formline>
                </vc>
            </formgroup>

            <formgroup text="{Global limits}">
                <vc>
                    <formline text="{Download speed}">
                        <hc>
                            <textbox type="number" bind="speed_limit_down" />
                            <checkbox text="{Use}" bind="speed_limit_down_enabled" />
                        </hc>
                    </formline>
                    <formline text="{Upload speed}">
                        <hc>
                            <textbox type="number" bind="speed_limit_up" />
                            <checkbox text="{Use}" bind="speed_limit_up_enabled" />
                        </hc>
                    </formline>
                    <formline text="{Ratio}">
                        <hc>
                            <textbox type="number" bind="seed_ratio_limit" />
                            <checkbox text="{Use}" bind="seed_ratio_limited" />
                        </hc>
                    </formline>
                </vc>
            </formgroup>

            <formgroup text="{Alternate limits}">
                <vc>
                    <formline text="{Download speed}">
                        <textbox type="number" bind="alt_speed_down" />
                    </formline>
                    <formline text="{Upload speed}">
                        <textbox type="number" bind="alt_speed_up" />
                    </formline>
                    <formline text="{Enabled}">
                        <checkbox text="{Active}" bind="alt_speed_enabled" />
                    </formline>
                </vc>
            </formgroup>

            <formgroup text="{Alternate limits schedule}">
                <vc>
                    <formline text="{Start time}">
                        <textbox type="number" bind="alt_speed_time_begin" />
                    </formline>
                    <formline text="{End time}">
                        <textbox type="number" bind="alt_speed_time_end" />
                    </formline>
                    <formline text="{Days}">
                        <textbox type="number" bind="alt_speed_time_day" />
                    </formline>
                    <formline text="{Enabled}">
                        <checkbox text="{Active}" bind="alt_speed_time_enabled" />
                    </formline>
                </vc>
            </formgroup>

            <formgroup text="{Peer limits}">
                <vc>
                    <formline text="{Maximum peers}">
                        <textbox type="number" bind="peer_limit_global" />
                    </formline>
                    <formline text="{Max peers per torrent}">
                        <textbox type="number" bind="peer_limit_per_torrent" />
                    </formline>
                </vc>
            </formgroup>

            <formgroup text="{Connection options}">
                <vc>
                    <formline text="{Use blocklist}">
                        <checkbox text="{Active}" bind="blocklist_enabled" />
                    </formline>
                    <formline text="{DHT enabled}">
                        <checkbox text="{Active}" bind="dht_enabled" />
                    </formline>
                    <formline text="{PeX enabled}">
                        <checkbox text="{Active}" bind="pex_enabled" />
                    </formline>
                    <formline text="{Encryption}">
                        <dropdown values="['required', 'preferred', 'tolerated']" labels="['Required', 'Preferred', 'Tolerated']" bind="encryption" />
                    </formline>
                    <formline text="{Peer port}">
                        <textbox type="number" bind="peer_port" />
                        <checkbox text="{Randomize on start}" bind="peer_port_random_on_start" />
                    </formline>
                    <formline text="{Port forwarding}">
                        <checkbox text="{Active}" bind="port_forwarding_enabled" />
                    </formline>
                </vc>
            </formgroup>
        </pad>
    </dialog>

</body>
